<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>シフトタイマー</title>
    <link rel="apple-touch-icon" href="icon.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <style>
        :root { --primary: #007AFF; --bg: #F2F2F7; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background: var(--bg); margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        .container { width: 100%; max-width: 400px; }
        h1 { font-size: 20px; text-align: center; color: #333; }
        .card { background: white; border-radius: 15px; padding: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-bottom: 20px; text-align: center; }
        .timer { font-size: 32px; font-weight: bold; color: var(--primary); margin: 10px 0; }
        .info { font-size: 14px; color: #666; line-height: 1.6; }
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        button { background: white; border: 1px solid #ddd; border-radius: 10px; padding: 15px 5px; font-size: 16px; font-weight: bold; cursor: pointer; transition: 0.2s; }
        button.active { background: var(--primary); color: white; border-color: var(--primary); }
        .day-type { display: flex; justify-content: center; gap: 10px; margin-bottom: 20px; }
        .day-btn { flex: 1; padding: 10px; border-radius: 8px; border: none; background: #ddd; }
        .day-btn.active { background: #333; color: white; }
    </style>
</head>
<body>

<div class="container">
    <h1>シフトタイマー</h1>

    <div class="day-type">
        <button id="btn-weekday" class="day-btn active" onclick="setDayType('weekday')">平日</button>
        <button id="id-holiday" class="day-btn" onclick="setDayType('holiday')">土日祝</button>
    </div>

    <div class="card">
        <div id="target-label" style="font-size: 14px; color:#888;">シフトを選択してください</div>
        <div id="countdown" class="timer">--:--:--</div>
        <div id="detail-info" class="info"></div>
    </div>

    <div id="shift-grid" class="grid"></div>
</div>

<script>
const data = {
    weekday: [
        { s: "06:30", w: "03:40", d: "05:02", t: "00特 (乗換11分)" },
        { s: "07:30", w: "04:49", d: "06:04", t: "00特 (乗換16分)" },
        { s: "07:45", w: "05:02", d: "06:17", t: "13特 (乗換12分)" },
        { s: "08:00", w: "05:17", d: "06:32", t: "26特 (乗換11分)" },
        { s: "08:30", w: "05:35", d: "06:50", t: "50特 (乗換13分)" },
        { s: "09:00", w: "06:11", d: "07:26", t: "26特 (乗換12分)" },
        { s: "10:00", w: "07:14", d: "08:29", t: "32急 (乗換16分)" },
        { s: "12:00", w: "09:13", d: "10:28", t: "23急 (乗換11分)" },
        { s: "13:00", w: "10:23", d: "11:38", t: "33急 (乗換11分)" },
        { s: "13:30", w: "10:53", d: "12:08", t: "03急 (乗換11分)" }
    ],
    holiday: [
        { s: "06:30", w: "03:40", d: "05:02", t: "00特 (乗換11分)" },
        { s: "07:30", w: "04:25", d: "05:40", t: "58特 (乗換17分)" },
        { s: "07:45", w: "04:53", d: "06:08", t: "02各 (乗換17分)" },
        { s: "08:00", w: "05:08", d: "06:23", t: "16各 (乗換12分)" },
        { s: "08:30", w: "05:38", d: "06:53", t: "51急 (乗換15分)" },
        { s: "09:00", w: "06:08", d: "07:23", t: "23急 (乗換16分)" },
        { s: "10:00", w: "07:24", d: "08:39", t: "33急 (乗換11分)" },
        { s: "13:30", w: "10:43", d: "11:58", t: "00特 (乗換17分 ※尼で同ホーム)" }
    ]
};

let currentDayType = 'weekday';
let selectedShift = null;

function setDayType(type) {
    currentDayType = type;
    document.querySelectorAll('.day-btn').forEach(b => b.classList.remove('active'));
    document.getElementById(type === 'weekday' ? 'btn-weekday' : 'id-holiday').classList.add('active');
    renderButtons();
}

function renderButtons() {
    const grid = document.getElementById('shift-grid');
    grid.innerHTML = '';
    data[currentDayType].forEach(item => {
        const btn = document.createElement('button');
        btn.innerText = item.s;
        btn.onclick = () => selectShift(item);
        if (selectedShift && selectedShift.s === item.s) btn.classList.add('active');
        grid.appendChild(btn);
    });
}

function selectShift(item) {
    selectedShift = item;
    renderButtons();
    updateTimer();
}

function updateTimer() {
    if (!selectedShift) return;
    
    const now = new Date();
    const target = new Date();
    const [h, m] = selectedShift.d.split(':');
    target.setHours(h, m, 0);

    // すでに時間を過ぎている場合は翌日の時間に
    if (target < now) target.setDate(target.getDate() + 1);

    const diff = target - now;
    const hours = Math.floor(diff / 3600000);
    const mins = Math.floor((diff % 3600000) / 60000);
    const secs = Math.floor((diff % 60000) / 1000);

    document.getElementById('target-label').innerText = `${selectedShift.s} シフトの出発まで`;
    document.getElementById('countdown').innerText = 
        `${String(hours).padStart(2, '0')}:${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
    document.getElementById('detail-info').innerHTML = 
        `起床：${selectedShift.w}<br>電車：${selectedShift.t}`;
}

setInterval(updateTimer, 1000);
renderButtons();
</script>
</body>
</html>
